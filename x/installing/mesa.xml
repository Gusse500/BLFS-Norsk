<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY mesa-download-http "https://mesa.freedesktop.org/archive/mesa-&mesa-version;.tar.xz">
  <!ENTITY mesa-download-ftp  " ">
  <!ENTITY mesa-md5sum        "9e7fa53b68fa6b60dba0bbfa8da7d0a9">
  <!ENTITY mesa-size          "20 MB">
  <!ENTITY mesa-buildsize     "618 MB (med dokumenter, legg til 220 MB for tester)">
  <!ENTITY mesa-time          "3.1 SBU (med dokumenter; legg til 0,6 SBU for tester; begge med parallellitet=4)">
]>

<sect1 id="mesa" xreflabel="Mesa-&mesa-version;">
  <?dbhtml filename="mesa.html"?>

  <title>Mesa-&mesa-version;</title>

  <indexterm zone="mesa">
    <primary sortas="a-Mesa">Mesa</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduksjon til Mesa</title>

    <para>
      <application>Mesa</application> er en OpenGL kompatibel 3D grafikk
      bibliotek.
    </para>

    <note>
      <para>
        <application>Mesa</application> oppdateres relativt ofte. Du kanskje
        ønsker å bruke den siste tilgjengelige &mesa-major-minor;.x mesa versjonen.
      </para>
    </note>

    &lfs121_checked;

    <bridgehead renderas="sect3">Pakkeinformasjon</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Nedlasting (HTTP): <ulink url="&mesa-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Nedlasting (FTP): <ulink url="&mesa-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Nedlasting MD5 sum: &mesa-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Nedlastingsstørrelse: &mesa-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimert diskplass som kreves: &mesa-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimert byggetid: &mesa-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Ytterligere Nedlastinger</bridgehead>
    <itemizedlist spacing="compact">
    <!-- 9 Apr 23.  Change to unversioned patch since it never changes. -->
      <listitem>
        <para>
          Anbefalt oppdatering:
          <ulink url="&patch-root;/mesa-add_xdemos-2.patch"/>
          (installerer 2 demoprogrammer for testing av Mesa - ikke nødvendig hvis du
          installer <ulink url="https://archive.mesa3d.org/demos/">
          mesa-demos</ulink> pakken)
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Mesa Avhengigheter</bridgehead>

    <bridgehead renderas="sect4">Påkrevd</bridgehead>
    <para role="required">
      <xref linkend="xorg7-lib"/>,
      <xref linkend="libdrm"/>, og
      <xref linkend="Mako"/>
    </para>

    <bridgehead renderas="sect4">Anbefalt</bridgehead>
    <para role="recommended">

      <xref linkend="glslang"/> (påkrevd for Vulkan støtte),

      <xref role="first" linkend="libva"/> (for å gi VA-API støtte for noen
      gallium drivere, merk at det er en sirkulær avhengighet. Du må
      bygge <application>libva</application> først uten EGL og GLX støtte,
      installer denne pakken og bygg på nytt <application>libva</application>),

      <xref linkend="libvdpau"/> (for å bygge VDPAU drivere),

      <xref linkend="llvm"/> (kreves for Gallium3D, nouveau og radeonsi
      drivere og for swrast, programvaren rasterizer som noen ganger refereres til
      til som llvmpipe. Se <ulink role="nodep"
      url="https://docs.mesa3d.org/systems.html"/> for mer informasjon),

      <xref linkend="wayland-protocols"/> (påkrevd for
        <xref role="nodep" linkend='plasma5-build'/>,
        GNOME, og anbefales for <xref role="nodep" linkend='gtk3'/>), og

      <xref linkend="vulkan-loader"/> (påkrevd for Vulkan støtte)
    </para>

    <bridgehead renderas="sect4">Valgfri</bridgehead>
    <para role="optional">
      <xref linkend="libgcrypt"/>,
      <xref linkend="libunwind"/>,
      <xref linkend="lm_sensors"/> <!-- for libsensors according to Meson -->,
      <xref linkend="nettle"/>,
      <xref linkend="valgrind"/>,
      <ulink url="https://archive.mesa3d.org/demos/">mesa-demos</ulink>
      (gir mer enn 300 ekstra demoer for å teste
      <application>Mesa</application>; dette inkluderer de samme programmene lagt til av
      oppdateringen ovenfor),
      <ulink url="https://omxil.sourceforge.net/">Bellagio OpenMAX Integration
      Layer</ulink> (for mobile platforms), og
      <!--<ulink url="https://github.com/KhronosGroup/glslang">glslang</ulink>
      (for vulkan drivere),-->
      <ulink url="https://github.com/tizonia/tizonia-openmax-il/wiki/Tizonia-OpenMAX-IL/">
      libtizonia</ulink>,
      <!--<ulink url="https://github.com/KhronosGroup/Vulkan-Loader">Vulkan-Loader</ulink>-->
    </para>
<!--
    <note>
      <para>
        Instruksjonene nedenfor forutsetter at
        <application>LLVM</application> med r600/amdgpu og vertsbakstykke
        og informasjon om kjøretidstype (RTTI - nødvendig for nouveau) er installert.
        Du må endre instruksjonene hvis du
         velger å ikke installere alle disse. For en forklaring av Gallium3D se
        <ulink url="https://en.wikipedia.org/wiki/Gallium3D"/>.
      </para>
    </note>
-->
  </sect2>

  <sect2 role="kernel" id="mesa-kernel"
         xreflabel='Mesa Kernel Configuration'>
    <title>Kjernekonfigurasjon</title>

    <para>
      Aktiver følgende alternativer i kjernekonfigurasjonen og
      kompiler kjernen på nytt om nødvendig:
     </para>

    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
      href="mesa-kernel.xml"/>

    <note>
      <para>
        Det tilsvarende Mesa Gallium3D drivernavnet er gitt som
        kommentar for konfigurasjonsoppføringene. Hvis du ikke vet navnet
        på Mesa Gallium3D driveren for din GPU, se <xref
        linkend="mesa-gallium-drivers"/> under.
      </para>

      <para>
        <option>CONFIG_DRM_RADEON</option>,
        <option>CONFIG_DRM_AMDGPU</option>,
        <option>CONFIG_DRM_NOUVEAU</option>, og
        <option>CONFIG_DRM_I915</option> kan kreve fastvare.
        Se <xref linkend='postlfs-firmware'/> for detaljer.
      </para>

      <para>
        Å velge <option>CONFIG_DRM_RADEON</option> eller
        <option>CONFIG_DRM_AMDGPU</option> som
        <quote><literal>y</literal></quote> anbefales ikke. Hvis det er, alle
        nødvendige fastvare må bygges som en del av kjernebildet eller
        initramfs for at driveren skal fungere riktig.
      </para>

      <para>
        Underpostene under <option>CONFIG_DRM_AMDGPU</option> er brukt
        for å sikre at AMDGPU kjernedriveren støtter alle GPUer som bruker
        <literal>radeonsi</literal> driver. De er ikke nødvendig hvis du
        ikke trenger <option>CONFIG_DRM_AMDGPU</option>. De
        kan være unødvendig for noen GPU modeller.
      </para>

      <para>
        For <literal>swrast</literal>, <option>CONFIG_DRM_VGEM</option>
        er strengt tatt ikke nødvendig, men anbefales som en optimalisering.
      </para>
    </note>
    <indexterm zone="mesa mesa-kernel">
      <primary sortas="d-mesa">mesa</primary>
    </indexterm>
  </sect2>

  <sect2 role="installation">
    <title>Installasjon av Mesa</title>
    <para>
      Hvis du har lastet ned xdemos oppdateringen (nødvendig hvis du tester Xorg
      installasjon i henhold til BLFS instruksjoner), bruk den ved å kjøre følgende
      kommando:
    </para>

<!--<screen><userinput>patch -Np1 -i ../mesa-&mesa-version;-add_xdemos-1.patch</userinput></screen>-->
<screen><userinput>patch -Np1 -i ../mesa-add_xdemos-2.patch</userinput></screen>

   <!-- Note that freedreno, vc4, and virgl all need special support from
        libdrm - renodr
        For me, libdrm does not mention virgl, but mesa accepts it. AFAICS
        freedreno is for qualcom hardware, libdrm will build for it on suitable
        systems. VC4 is for the Broadcom VC4 used in the raspberry pi - ken -->
<!--
    <note>
      <para>
        Målene ovenfor, og innholdet nedenfor, er for en fullstendig konstruksjon.
        Mange vil ikke ønske å installere drivere de ikke kan bruke, så
        følgende avsnitt forklarer hvordan man begrenser sjåførene, og gir en
        eksempel som kan reduseres eller endres etter behov.
      </para>
    </note>

-->
<!--
    <para>
      (ikke-gallium) DRI-driverne tilgjengelig i X86 er auto, <emphasis>eller
      alternativt et valg fra</emphasis> i915, i965, nouveau, r100, r200,
      og swrast. Bruk 'auto' for å bygge alle tilgjengelige DRI-drivere, eller bruk en
      tom streng (DRI_DRIVERS="") hvis du kun ønsker å bygge gallium-drivere.
    </para>

    <para>
      Plattformene ("vindussystemene") tilgjengelig for X86 linux er x11, wayland,
      drm, og uten overflate. Ved ikke å spesifisere noe, mesonen
      build-system vil bygge for alle disse plattformene hvis du har
      avhengigheter, identiske med hvis du hadde spesifisert '-Dplatforms=auto'.
    </para>

    <para>
      Endre kommandoene nedenfor for dine ønskede drivere. Driverne som er oppført
      nedenfor vil dekke de fleste moderne skjermkort og virtuelle maskiner. For hjelp i
      velge sjåfører se <ulink url="https://docs.mesa3d.org/systems.html"/>.
-->
      <!-- these two don't seem to be mentioned in that mesa link -->
<!--
      For Intel-drivere, spesifiser Crocus for i965 gen 4 til Haswell, iris
      for Broadwell og senere.
    </para>

    <note>
      <para>
        Selv om nouveau-driverne kan bygges for både gallium og dri, er de
        i915-driveren kan bare bygges for den ene eller den andre.
      </para>
    </note>

<screen><userinput>GALLIUM_DRV="crocus,i915,iris,nouveau,r600,radeonsi,svga,swrast,virgl"
DRI_DRIVERS="i965,nouveau"</userinput></screen>
-->

    <!-- https://gitlab.freedesktop.org/mesa/mesa/-/merge_requests/22021 -->
<!-- No longer needed
    <para>
      Remove two unneeded references to LLVM headers to avoid a build
      failure with LLVM 17 or later:
    </para>

<screen><userinput>sed '/Scalar.h/d;/Utils.h/d' \
    -i src/gallium/auxiliary/gallivm/lp_bld_init.c</userinput></screen>
-->
    <para>
      Installer <application>Mesa</application> ved å kjøre følgende
      kommandoer:
    </para>

<screen><userinput>mkdir build &amp;&amp;
cd    build &amp;&amp;

meson setup                   \
      --prefix=$XORG_PREFIX   \
      --buildtype=release     \
      -Dplatforms=x11,wayland \
      -Dgallium-drivers=auto  \
      -Dvulkan-drivers=auto   \
      -Dvalgrind=disabled     \
      -Dlibunwind=disabled    \
      ..                      &amp;&amp;

ninja</userinput></screen>

    <para>
      For å teste resultatene, utsted:
      <command>meson configure -Dbuild-tests=true &amp;&amp; ninja test</command>.
    </para>
<!-- All 88 tests passed for me for 22.3.3 [pierre]
     All 90 tests passed for me for 23.1.0 [bdubbs]
     89 Tests passed for me, 1 timeout on 23.1.8 [rahul]
     All 98 tests passed for me for 23.3.1 [bdubbs]
-->

    <para>
      Nå, som <systemitem class="username">root</systemitem> bruker:
    </para>

<screen role="root"><userinput>ninja install</userinput></screen>

    <para>
      Hvis ønskelig, installer den valgfrie dokumentasjonen ved å kjøre
      følgende kommandoer som
      <systemitem class="username">root</systemitem> bruker:
    </para>

<screen role="root"
         remap="doc"><userinput>cp -rv ../docs -T /usr/share/doc/mesa-&mesa-version;</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Parameterforklaringer</title>

    <para>
      <parameter>--buildtype=release</parameter>: Denne bryteren sikrer et
      fullt optimalisert bygg, og deaktiverer feilsøkingspåstander som vil
      kraftig bremse ned bibliotekene i visse brukstilfeller. Uten denne
      bryteren, kan byggestørrelsene spenne over 2 GB.
    </para>

    <para>
      <anchor id='mesa-gallium-drivers' xreflabel='Mesa Gallium3D Drivers'/>
      <parameter>-Dgallium-drivers=auto</parameter>: Denne parameteren
      kontrollerer hvilke Gallium3D drivere som skal bygges.
      <literal>auto</literal> velger alle tilgjengelige Gallium3D drivere
      for x86: <literal>r300</literal> (for ATI Radeon 9000 eller Radeon X
      serier), <literal>r600</literal> (for AMD/ATI Radeon HD 2000-6000
      serier), <literal>radeonsi</literal> (for AMD Radeon HD 7000 eller nyere
      AMD GPU modeller), <literal>nouveau</literal>
      (for støttede NVIDIA GPUer er de oppført som alle
      <quote>3D features</quote> enten <quote>DONE</quote> eller
      <quote>N/A</quote> in <ulink
      url='https://nouveau.freedesktop.org/FeatureMatrix.html'>the Nouveau
      status page</ulink>), <literal>virgl</literal> (for QEMU virtual GPU
      med <application>virglrender</application> støtte; merk at BLFS
      <xref linkend='qemu'/> ikke er bygget med
      <application>virglrender</application>), <literal>svga</literal>
      (for VMWare virtual GPU), <literal>swrast</literal> (bruker CPU for 3D
      rasterisering; Vær oppmerksom på at det er mye tregere enn å bruke en moderne
      3D-kompatibel GPU, så den bør bare brukes hvis GPUen ikke støttes
      av andre drivere), <literal>iris</literal> (for Intel GPUs sendt
      med Broadwell eller nyere CPUer), <literal>crocus</literal> (for Intel
      GMA 3000, X3000 serier, 4000 serier, or X4000 serier GPUer levert med
      brikkesett, eller Intel HD GPUer levert med pre-Broadwell CPUs),
      <literal>i915</literal> (for Intel GMA 900, 950, 3100, eller 3150 GPUer
      leveres med brikkesett eller Atom D/N 4xx/5xx CPUer). Du kan erstatte
      <literal>auto</literal> med en kommadelt liste kun for å bygge
      en undergruppe av disse driverne hvis du nøyaktig vet hvilke drivere du
      trenger for eksempel
      <option>-Dgallium-drivers=radeonsi,iris,swrast</option>.
    </para>
<!--
    <para>
      <parameter>-Dosmesa=true</parameter>: Denne bryteren aktiverer bygging av
      <filename class="libraryfile">libOSMesa</filename> bibliotek og
      gir Gallium3D støtte i den. Det krever swrast gallium driveren.
    </para>
-->

    <para>
      <parameter>-Dplatforms=...</parameter>: Denne parameteren
      kontrollerer hvilke vindussystemer som skal støttes. Tilgjengelige
      linux plattformer er x11 og wayland.
    </para>

    <para>
      <parameter>-Dvulkan-drivers=auto</parameter>: Denne bryteren muliggjør støtte
      for Vulkan grafikk API. Den bygger automatisk alle grafikkdrivere
      som er tilgjengelig for Vulkan. Hvis du ønsker å bygge spesifikke drivere,
      gyldige alternativer inkluderer 'amd', 'intel', 'intel_hasvk' og 'swrast'. Hvis du
      ikke ønsker Vulkan støtte, endre 'auto' til "".
    </para>

    <para>
      <parameter>-Dvalgrind=disabled</parameter>: Denne parameteren deaktiverer
      bruken av Valgrind under byggeprosessen. Fjern denne parameteren
      hvis du har Valgrind installert, og ønsker å se etter minnelekkasjer.
    </para>

    <para>
      <parameter>-Dlibunwind=disabled</parameter>: Denne parameteren deaktiverer
      bruken av libunwind.
    </para>

    <para>
      <command>meson configure -Dbuild-tests=true</command>: Denne kommandoen vil
      rekonfigurere byggingen for å sette <option>-Dbuild-tests=true</option>, men
      behold de andre alternativene som er spesifisert i <command>meson setup</command>
      kommandoen uendret. Det tillater <command>ninja test</command> å bygge og
      kjøre enhetstester.
    </para>

    <para>
      <option>-Degl-native-platform="..."</option>: Denne parameteren
      kontrollerer hvilken støtte for Embedded Graphics Library som skal bygges. Tilgjengelig
      linux alternativer er auto (standard), x11, wayland, surfaceless og drm.
    </para>

  </sect2>

  <sect2 role="content">
    <title>Innhold</title>

    <segmentedlist>
      <segtitle>Installerte Programmer</segtitle>
      <segtitle>Installerte Biblioteker</segtitle><!-- in /usr/lib -->
      <segtitle>Installerte DRI Drivere</segtitle><!-- in /usr/lib/dri -->
      <segtitle>Installerte VDPAU Drivere</segtitle><!-- in /usr/lib/vdpau -->
      <segtitle>Installerte Vulkan Drivere</segtitle><!-- in /usr/lib -->
      <segtitle>Installerte Mapper</segtitle>

      <seglistitem>
        <seg>
          glxgears og glxinfo
        </seg>
        <seg>
          libEGL.so,
          libGL.so,
          libGLESv1_CM.so,
          libGLESv2.so,
          libgbm.so,
          libglapi.so, og
          libxatracker.so
        </seg>
        <seg>
          <!-- d3dadapter9.so (optional)
               I guess this is useless today, Wine applications use Vulkan
               through libvkd3d, and new games with native Linux support
               likely uses Vulkan directly.  -->
          <!-- Begin gallium DRI drivers (*_dri.so) and VA-API drivers
               (*_drv_video.so): this is the full set -->
          crocus_dri.so,
          i915_dri.so,
          iris_dri.so,
          kms_swrast_dri.so,
          nouveau_dri.so,
          nouveau_drv_video.so,
          r300_dri.so,
          r600_dri.so,
          r600_drv_video.so,
          radeonsi_dri.so,
          radeonsi_drv_video.so,
          swrast_dri.so,
          virtio_gpu_dri.so,
          virtio_gpu_drv_video.so, og
          vmwgfx_dri.so
          <!-- End DRI Drivers -->
        </seg>
        <seg>
          <!-- Begin VDPAU drivers -->
          libvdpau_nouveau.so,
          libvdpau_r300.so
          libvdpau_r600.so, og
          libvdpau_radeonsi.so
          libvdpau_virtio_gpu.so
          <!-- End VDPAU drivers -->
          (Mange av disse driverne er hardt koblet).
        </seg>
        <seg>
          libvulkan_intel_hasvk.so,
          libvulkan_intel.so,
          libvulkan_lvp.so, and
          libvulkan_radeon.so
        </seg>
        <seg>
          <!-- $XORG_PREFIX/include/GL is installed by xorg-protos -->
          $XORG_PREFIX/{include/{EGL,GLES,GLES2,GLES3,KHR},
          $XORG_PREFIX/lib/{dri,vdpau}},
          $XORG_PREFIX/share/drirc.d (inneholder løsninger for ulike applikasjoner,
          spesielt nettlesere og spill),
          $XORG_PREFIX/share/vulkan,
          and /usr/share/doc/mesa-&mesa-version;
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Korte Beskrivelser</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="glxgears">
        <term><command>glxgears</command></term>
        <listitem>
          <para>
            er en GL demo som er nyttig for feilsøking av grafikk
            problemer
          </para>
          <indexterm zone="mesa glxgears">
            <primary sortas="b-glxgears">glxgears</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="glxinfo">
        <term><command>glxinfo</command></term>
        <listitem>
          <para>
            er et diagnoseprogram som viser informasjon om
            grafikkmaskinvare og installerte GL biblioteker
          </para>
          <indexterm zone="mesa glxinfo">
            <primary sortas="b-glxinfo">glxinfo</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libEGL">
        <term><filename class="libraryfile">libEGL.so</filename></term>
        <listitem>
          <para>
            gir et grunnleggende plattformgrafikkgrensesnitt som
            definert av EGL-1.4 spesifikasjonen
          </para>
          <indexterm zone="mesa libEGL">
            <primary sortas="c-libGL">libEGL.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libgbm">
        <term><filename class="libraryfile">libgbm.so</filename></term>
        <listitem>
          <para>
            er <application>Mesa</application> Grafikkbuffer
            behandlingsbiblioteket
          </para>
          <indexterm zone="mesa libgbm">
            <primary sortas="c-libgbm">libgbm.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libGLESv1_CM">
        <term><filename class="libraryfile">libGLESv1_CM.so</filename></term>
        <listitem>
          <para>
            er <application>Mesa</application> OpenGL ES 1.1 biblioteket
          </para>
          <indexterm zone="mesa libGLESv1_CM">
            <primary sortas="c-libGLESv1_CM">libGLESv1_CM.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libGLES2">
        <term><filename class="libraryfile">libGLES2.so</filename></term>
        <listitem>
          <para>
            er <application>Mesa</application> OpenGL ES 2.0 biblioteket
          </para>
          <indexterm zone="mesa libGLES2">
            <primary sortas="c-libGLES2">libGLES2.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libGL">
        <term><filename class="libraryfile">libGL.so</filename></term>
        <listitem>
          <para>
            er <application>Mesa</application> OpenGL hovedbiblioteket
          </para>
          <indexterm zone="mesa libGL">
            <primary sortas="c-libGL">libGL.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
